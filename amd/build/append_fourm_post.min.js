define("tiny_cursive/append_fourm_post",["jquery","core/ajax","core/str","core/templates","./replay","./analytic_button","./analytic_events"],(function($,AJAX,str,templates,Replay,analyticButton,AnalyticEvents){const replayInstances={};window.video_playback=function(mid,filepath){if(""!==filepath){const replay=new Replay("content"+mid,filepath,10,!1,"player_"+mid);replayInstances[mid]=replay}else templates.render("tiny_cursive/no_submission").then((html=>($("#content"+mid).html(html),!0))).catch((e=>window.console.error(e)));return!1};var usersTable={init:function(scoreSetting,showcomment,hasApiKey){str.get_strings([{key:"field_require",component:"tiny_cursive"}]).done((function(){usersTable.getToken(scoreSetting,showcomment,hasApiKey)}))},getToken:function(scoreSetting,showcomment,hasApiKey){$("#page-mod-forum-discuss").find("article").get().forEach((function(entry){var replyButton=$('a[data-region="post-action"][title="Reply"]');replyButton.length>0&&replyButton.on("click",(function(event){event.preventDefault();var url=$(this).attr("href");window.location.href=url}));var ids=$("#"+entry.id).data("post-id"),cmid=M.cfg.contextInstanceId;let args={id:ids,modulename:"forum",cmid:cmid},com=AJAX.call([{methodname:"cursive_get_forum_comment_link",args:args}]);return com[0].done((function(json){var data=JSON.parse(json),filepath="";if(data.data.filename&&(filepath=data.data.filename),filepath){let analyticButtonDiv=document.createElement("div");analyticButtonDiv.append(analyticButton(ids)),analyticButtonDiv.classList.add("text-center","my-2"),analyticButtonDiv.dataset.region="analytic-div"+ids,$("#"+entry.id).find("#post-content-"+ids).prepend(analyticButtonDiv);let myEvents=new AnalyticEvents;var context={tabledata:data.data,formattime:myEvents.formatedTime(data.data),page:scoreSetting,userid:ids,apikey:hasApiKey};let authIcon=myEvents.authorshipStatus(data.data.first_file,data.data.score,scoreSetting);myEvents.createModal(ids,context,"",replayInstances,authIcon),myEvents.analytics(ids,templates,context,"",replayInstances,authIcon),myEvents.checkDiff(ids,data.data.file_id,"",replayInstances),myEvents.replyWriting(ids,filepath,"",replayInstances)}})),com.usercomment}))}};return usersTable}));

//# sourceMappingURL=append_fourm_post.min.js.map