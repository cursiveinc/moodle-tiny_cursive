define("tiny_cursive/token_approve",["jquery","core/ajax","core/str"],(function($,AJAX,str){var usersTable={init:function(page){str.get_strings([{key:"field_require",component:"tiny_cursive"}]).done((function(){usersTable.getToken(page),usersTable.generateToken()}))},getToken:function(){$("#approve_token").click((function(){var token=$("#id_s_tiny_cursive_secretkey").val();AJAX.call([{methodname:"cursive_approve_token",args:{token:token}}])[0].done((function(json){var data=JSON.parse(json),messageAlert="";messageAlert=1==data.status?"<span class='alert alert-success' role='alert'>"+data.message+"</span>":"<span class='alert alert-danger' role='alert'>"+data.message+"</span>",$("#token_message").html(messageAlert)}))}))},generateToken(){var generateToken=$("#generate_cursivetoken"),cursiveDisable=$("#cursivedisable");generateToken.on("click",(function(e){e.preventDefault();var promise1=AJAX.call([{methodname:"cursive_generate_webtoken",args:[]}]);promise1[0].done((function(data){var messageAlert="";str.get_strings([{key:"webservtokengensucc",component:"tiny_cursive"},{key:"webservtokengenfail",component:"tiny_cursive"}]).then((function(_ref){let[success,fail]=_ref;return data.token?($("#id_s_tiny_cursive_cursivetoken").val(data.token),messageAlert=`<span class='text-success' role='alert'>${success}</span>`):messageAlert=`<span class='text-danger' role='alert'>${fail}</span>`,$("#cursivetoken_").html(messageAlert),setTimeout((()=>{$("#cursivetoken_").empty()}),3e3),!0})).catch((error=>window.console.error(error)))})),promise1[0].fail((function(textStatus){var errorMessage="<span class='text-danger' role='alert'>";str.get_string("webservtokenerror","tiny_cursive").then((str=>(errorMessage+=str+" "+textStatus.error+"</span>",$("#cursivetoken_").html(errorMessage),setTimeout((function(){$("#cursivetoken_").empty()}),3e3),!0))).catch((error=>window.console.error(error)))}))})),cursiveDisable.on("click",(function(e){e.preventDefault();var promise1=AJAX.call([{methodname:"cursive_disable_all_course",args:{disable:!0}}]);promise1[0].done((function(data){var messageAlert="";str.get_strings([{key:"cursive:succ",component:"tiny_cursive"},{key:"cursive:fail",component:"tiny_cursive"}]).then((function(_ref2){let[success,fail]=_ref2;return messageAlert=data?`<span class='text-success' role='alert'>${success}</span>`:`<span class='text-danger' role='alert'>${fail}</span>`,$("#cursivedisable_").html(messageAlert),setTimeout((()=>{$("#cursivedisable_").empty()}),3e3),!0})).catch((error=>window.console.error(error)))})),promise1[0].fail((function(textStatus){var errorMessage="<span class='text-danger' role='alert'>";str.get_string("cursive:status","tiny_cursive").then((str=>(errorMessage+=str+" "+textStatus.error+"</span>",$("#cursivedisable_").html(errorMessage),setTimeout((function(){$("#cursivedisable_").empty()}),3e3),!0))).catch((error=>window.console.error(error)))}))}))}};return usersTable}));

//# sourceMappingURL=token_approve.min.js.map