define("tiny_cursive/token_approve",["core/ajax","core/str"],(function(AJAX,str){var usersTable={init:function(page){str.get_strings([{key:"field_require",component:"tiny_cursive"}]).done((function(){usersTable.getToken(page),usersTable.generateToken()}))},getToken:function(){const approveTokenBtn=document.getElementById("approve_token");approveTokenBtn&&approveTokenBtn.addEventListener("click",(function(){const tokenInput=document.getElementById("id_s_tiny_cursive_secretkey");var token=tokenInput?tokenInput.value:"";AJAX.call([{methodname:"cursive_approve_token",args:{token:token}}])[0].done((function(json){var data=JSON.parse(json),messageAlert="";messageAlert=1==data.status?"<span class='alert alert-success' role='alert'>"+data.message+"</span>":"<span class='alert alert-danger' role='alert'>"+data.message+"</span>";const tokenMessage=document.getElementById("token_message");tokenMessage&&(tokenMessage.innerHTML=messageAlert)}))}))},generateToken(){const generateToken=document.getElementById("generate_cursivetoken"),cursiveDisable=document.getElementById("cursivedisable"),cursiveEnable=document.getElementById("cursiveenable");generateToken&&generateToken.addEventListener("click",(function(e){e.preventDefault();var promise1=AJAX.call([{methodname:"cursive_generate_webtoken",args:[]}]);promise1[0].done((function(data){var messageAlert="";str.get_strings([{key:"webservtokengensucc",component:"tiny_cursive"},{key:"webservtokengenfail",component:"tiny_cursive"}]).then((function(_ref){let[success,fail]=_ref;if(data.token){const cursiveTokenInput=document.getElementById("id_s_tiny_cursive_cursivetoken");cursiveTokenInput&&(cursiveTokenInput.value=data.token),messageAlert="<span class='text-success' role='alert'>".concat(success,"</span>")}else messageAlert="<span class='text-danger' role='alert'>".concat(fail,"</span>");const cursiveTokenMsg=document.getElementById("cursivetoken_");return cursiveTokenMsg&&(cursiveTokenMsg.innerHTML=messageAlert,setTimeout((()=>{cursiveTokenMsg.innerHTML=""}),3e3)),!0})).catch((error=>window.console.error(error)))})),promise1[0].fail((function(textStatus){var errorMessage="<span class='text-danger' role='alert'>";str.get_string("webservtokenerror","tiny_cursive").then((str=>{errorMessage+=str+" "+textStatus.error+"</span>";const cursiveTokenMsg=document.getElementById("cursivetoken_");return cursiveTokenMsg&&(cursiveTokenMsg.innerHTML=errorMessage,setTimeout((function(){cursiveTokenMsg.innerHTML=""}),3e3)),!0})).catch((error=>window.console.error(error)))}))})),cursiveDisable&&cursiveDisable.addEventListener("click",(function(e){e.preventDefault();var promise1=AJAX.call([{methodname:"cursive_disable_all_course",args:{disable:!0}}]);promise1[0].done((function(data){var messageAlert="";str.get_strings([{key:"cursive:dis:succ",component:"tiny_cursive"},{key:"cursive:dis:fail",component:"tiny_cursive"}]).then((function(_ref2){let[success,fail]=_ref2;messageAlert=data?"<span class='text-success' role='alert'>".concat(success,"</span>"):"<span class='text-danger' role='alert'>".concat(fail,"</span>");const cursiveDisableMsg=document.getElementById("cursivedisable_");return cursiveDisableMsg&&(cursiveDisableMsg.innerHTML=messageAlert,setTimeout((()=>{cursiveDisableMsg.innerHTML=""}),3e3)),!0})).catch((error=>window.console.error(error)))})),promise1[0].fail((function(textStatus){var errorMessage="<span class='text-danger' role='alert'>";str.get_string("cursive:status","tiny_cursive").then((str=>{errorMessage+=str+" "+textStatus.error+"</span>";const cursiveDisableMsg=document.getElementById("cursivedisable_");return cursiveDisableMsg&&(cursiveDisableMsg.innerHTML=errorMessage,setTimeout((function(){cursiveDisableMsg.innerHTML=""}),3e3)),!0})).catch((error=>window.console.error(error)))}))})),cursiveEnable&&cursiveEnable.addEventListener("click",(function(e){e.preventDefault();var promise1=AJAX.call([{methodname:"cursive_disable_all_course",args:{disable:!1}}]);promise1[0].done((function(data){var messageAlert="";str.get_strings([{key:"cursive:ena:succ",component:"tiny_cursive"},{key:"cursive:ena:fail",component:"tiny_cursive"}]).then((function(_ref3){let[success,fail]=_ref3;messageAlert=data?"<span class='text-success' role='alert'>".concat(success,"</span>"):"<span class='text-danger' role='alert'>".concat(fail,"</span>");const cursiveDisableMsg=document.getElementById("cursivedisable_");return cursiveDisableMsg&&(cursiveDisableMsg.innerHTML=messageAlert,setTimeout((()=>{cursiveDisableMsg.innerHTML=""}),3e3)),!0})).catch((error=>window.console.error(error)))})),promise1[0].fail((function(textStatus){var errorMessage="<span class='text-danger' role='alert'>";str.get_string("cursive:status","tiny_cursive").then((str=>{errorMessage+=str+" "+textStatus.error+"</span>";const cursiveDisableMsg=document.getElementById("cursivedisable_");return cursiveDisableMsg&&(cursiveDisableMsg.innerHTML=errorMessage,setTimeout((function(){cursiveDisableMsg.innerHTML=""}),3e3)),!0})).catch((error=>window.console.error(error)))}))}))}};return usersTable}));

//# sourceMappingURL=token_approve.min.js.map