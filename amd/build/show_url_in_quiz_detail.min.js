define("tiny_cursive/show_url_in_quiz_detail",["core/ajax","core/str","core/templates","./replay","./analytic_button","./analytic_events"],(function(AJAX,str,templates,Replay,analyticButton,AnalyticEvents){const replayInstances={};window.video_playback=function(mid,filepath,questionid){if(""!==filepath){const replay=new Replay("content"+mid,filepath,10,!1,"player_"+mid+questionid);replayInstances[mid]=replay}else templates.render("tiny_cursive/no_submission").then((function(html){const contentElement=document.getElementById("content"+mid);contentElement&&(contentElement.innerHTML=html)})).catch((function(e){console.error(e)}));return!1};var usersTable={init:function(score_setting,showcomment){str.get_strings([{key:"field_require",component:"tiny_cursive"}]).done((function(){usersTable.appendSubmissionDetail(score_setting,showcomment)}))},appendSubmissionDetail:function(score_setting,showcomment){let sub_url=window.location.href,attempt_id=new URL(sub_url).searchParams.get("attempt"),cmid=M.cfg.contextInstanceId,userid="";document.querySelectorAll("table.generaltable.generalbox.quizreviewsummary tbody tr").forEach((function(row){let hrefElement=row.querySelector('a[href*="/user/view.php"]');if(hrefElement){let id=hrefElement.getAttribute("href").match(/id=(\d+)/);id&&(userid=id[1])}})),document.querySelectorAll("#page-mod-quiz-review .info").forEach((function(element){let editQuestionLink=element.querySelector('.editquestion a[href*="question/bank/editquestion/question.php"]'),questionid=null;if(editQuestionLink){let editQuestionHref=editQuestionLink.getAttribute("href");questionid=editQuestionHref.match(/&id=(\d+)/)[1]}let args={id:attempt_id,modulename:"quiz",cmid:cmid,questionid:questionid,userid:userid},com=AJAX.call([{methodname:"cursive_get_comment_link",args:args}]);return com[0].done((function(json){let data=JSON.parse(json);if(data.data.filename){let content=document.querySelector('.que.essay .editquestion a[href*="question/bank/editquestion/question.php"][href*="&id='+data.data.questionid+'"]');if(content){let qtextElement=content.parentNode.parentElement.nextSibling.querySelector(".qtext");if("comments"!==data.usercomment&&parseInt(showcomment)&&qtextElement){let referencesDiv=document.createElement("div");referencesDiv.classList.add("mb-2"),qtextElement.append(referencesDiv);let tt='<h4>References</h4><div class="tiny_cursive-quiz-references rounded">';data.usercomment.forEach((function(element){tt+='<div class="text-primary p-3" style="border-bottom:1px solid rgba(0, 0, 0, 0.1)">'+element.usercomment+"</div>"})),qtextElement.innerHTML+=tt+"</div></div>"}let filepath=data.data.filename||"",analytic_button_div=document.createElement("div");analytic_button_div.classList.add("text-center","mt-2"),analytic_button_div.appendChild(analyticButton(userid,questionid)),qtextElement&&qtextElement.appendChild(analytic_button_div);let myEvents=new AnalyticEvents,context={tabledata:data.data,formattime:myEvents.formatedTime(data.data),page:score_setting,userid:userid,quizid:questionid},authIcon=myEvents.authorshipStatus(data.data.first_file,data.data.score,score_setting);myEvents.createModal(userid,context,questionid,authIcon),myEvents.analytics(userid,templates,context,questionid,replayInstances,authIcon),myEvents.checkDiff(userid,data.data.file_id,questionid,replayInstances),myEvents.replyWriting(userid,filepath,questionid,replayInstances)}}})),com.usercomment}))}};return usersTable}));

//# sourceMappingURL=show_url_in_quiz_detail.min.js.map