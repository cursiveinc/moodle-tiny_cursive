{"version":3,"file":"document_view.min.js","sources":["../src/document_view.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module provides functionality for document view management in the Tiny editor,\n * including full page mode display and sidebar information\n * @module     tiny_cursive/document_view\n * @copyright  2025 Cursive Technology, Inc. <info@cursivetechnology.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Icons from 'tiny_cursive/svg_repo';\nexport default class DocumentView {\n\n    constructor(User, Rubrics, submission, modulename, editor, quizInfo) {\n        this.User = User;\n        this.Rubrics = Rubrics;\n        this.submission = submission;\n        this.module = modulename;\n        this.editor = editor;\n        this.moduleIcon = Icons.assignment;\n        this.quizInfo = quizInfo;\n        this.initStrings();\n    }\n\n    normalMode() {\n        let id = this.editor?.id + \"_ifr\";\n        if (this.module === 'assign') {\n            this.normalizePage(id);\n        } else if (this.module === 'quiz') {\n            this.normalizePage(id);\n        } else if (this.module === 'forum') {\n            this.normalizePage(id);\n        } else if (this.module === 'lesson') {\n            this.normalizePage(id);\n        } else if(this.module === 'pdfannotator') {\n            this.normalizePage(id);\n        }\n    }\n\n    fullPageMode() {\n\n        if (this.module === 'assign') {\n            this.moduleIcon = Icons.assignment;\n            this.fullPageModule(this.editor?.id);\n        } else if (this.module === 'forum') {\n            this.moduleIcon = Icons.forum;\n            this.fullPageModule(this.editor?.id);\n        } else if (this.module === 'quiz' && this.editor?.id) {\n            this.moduleIcon = Icons.quiz;\n            this.fullPageModule(this.editor?.id);\n        } else if (this.module === 'lesson') {\n            this.moduleIcon = Icons.lesson;\n            this.fullPageModule(this.editor?.id);\n        } else if (this.module === 'pdfannotator') {\n            this.moduleIcon = Icons.pdfannotator;\n            this.fullPageModule(this.editor?.id);\n        }\n    }\n\n    docSideBar(status) {\n\n        const url = new URL(window.location.href);\n        const replyId = url.searchParams.get(\"reply\");\n        const toggle = document.querySelector('#cursive-fullpagemode-sidebar-toggle');\n        const timelimitBlock = this.getTimerBlock(this.module);\n        const headerInfo = this.getSidebarTitle();\n        const progressBar = document.querySelector('.box.progress_bar');\n\n        const courseName = document.querySelector('#page-navbar > nav > ol > li:nth-child(1) > a');\n        const courseDes = document.querySelector('#intro');\n        const Dates = document.querySelector('.activity-dates');\n\n        let openDate = Dates?.querySelector('div:nth-child(1)');\n        let dueDate = Dates?.querySelector('div:nth-child(2)');\n\n        const container = this.create('div');\n        Object.assign(container, {\n            id: 'cursive-fullpagemode-sidebar',\n            className: 'bg-white h-100 shadow'\n        });\n        Object.assign(container.style, {\n            width: '300px',\n            overflow: 'auto'\n        });\n\n        const crossBtn = this.create('span');\n        Object.assign(crossBtn, {\n            id: 'cursive-collapse-sidebar',\n            className: 'btn p-2',\n            innerHTML: Icons.close\n        });\n\n        crossBtn.addEventListener('click', () => {\n            container.style.transition = 'width 0.3s ease';\n            container.style.width = '0';\n            toggle.style.display = 'flex';\n        });\n        toggle?.addEventListener('click', function() {\n            toggle.style.display = 'none';\n            container.style.width = '300px';\n        });\n\n        const btnWrapper = this.create('div');\n        Object.assign(btnWrapper, {\n            padding: '0 1rem',\n            position: 'sticky',\n            top: '0',\n            backgroundColor: 'white'\n        });\n        btnWrapper.append(crossBtn);\n\n\n        const header = this.create('div');\n        header.className = 'border-bottom p-3 bg-light';\n        Object.assign(header.style, {\n            position: 'sticky',\n            top: '0'\n        });\n\n        const headerTitle = this.create('h3');\n        headerTitle.className = 'mb-3 d-flex align-items-center';\n        headerTitle.textContent = `${headerInfo.title} ${this.details}`;\n        headerTitle.style.fontWeight = '600';\n\n        const headerIcon = document.querySelector('.page-header-image > div');\n        if (headerIcon) {\n            headerTitle.prepend(headerIcon.cloneNode(true));\n        }\n\n        let wordCount = this.wordCounter(status);\n        if (timelimitBlock?.textContent) {\n            header.append(headerTitle, wordCount, this.timerCountDown(timelimitBlock));\n        } else {\n            header.append(headerTitle, wordCount);\n        }\n\n        const content = this.create('div');\n        content.className = 'p-3';\n\n        content.append(\n            this.createBox({\n                bg: 'bg-info',\n                titleColor: 'text-info',\n                icon: Icons.people,\n                title: this.studentInfo,\n                bodyHTML: this.generateStudentInfo(this.User, courseName)\n            })\n        );\n\n        if (this.module === 'lesson' && progressBar) {\n            content.append(\n                this.createBox({\n                    bg: 'bg-gray',\n                    titleColor: 'text-dark',\n                    icon: this.moduleIcon,\n                    title: this.progress,\n                    bodyHTML: progressBar.innerHTML\n                })\n            );\n        }\n\n        if (courseDes && courseDes?.textContent.trim() !== '') {\n            content.append(\n                this.createBox({\n                    bg: 'bg-gray',\n                    titleColor: 'text-dark',\n                    icon: this.moduleIcon,\n                    title: `${this.getSidebarTitle().title} ${this.description}`,\n                    bodyHTML: courseDes.innerHTML\n                })\n            );\n        }\n\n        if (this.module === 'forum' && replyId) {\n            this.checkForumSubject();\n            let replyPost = document.querySelector(`#post-content-${replyId}`);\n            if (replyPost?.textContent.trim()) {\n                content.append(\n                    this.createBox({\n                        bg: 'bg-gray',\n                        titleColor: 'text-dark',\n                        icon: this.moduleIcon,\n                        title: this.replyingto,\n                        bodyHTML: replyPost.textContent.trim()\n                    })\n                );\n            }\n        }\n\n        if (this.module === 'quiz' && this.editor?.id) {\n\n            let questionId = this.getQuestionId(this.editor?.id);\n            let question = document.querySelector(`#question-${questionId} .qtext`);\n            let intro = atob(this.quizInfo.intro);\n\n            if (question?.textContent.trim()) {\n                content.append(\n                    this.createBox({\n                        bg: 'bg-amber',\n                        titleColor: 'text-dark',\n                        icon: this.moduleIcon,\n                        title: this.answeringto,\n                        bodyHTML: question.textContent\n                    })\n                );\n            }\n\n            if (intro && intro.trim() !== '') {\n                content.append(\n                    this.createBox({\n                        bg: 'bg-gray',\n                        titleColor: 'text-dark',\n                        icon: this.moduleIcon,\n                        title: `${this.quiz} ${this.description}`,\n                        bodyHTML: intro\n                    })\n                );\n            }\n\n            if (Number(this.quizInfo.open)) {\n                content.append(\n                    this.createBox({\n                        bg: 'bg-amber',\n                        titleColor: 'text-dark',\n                        icon: Icons.time,\n                        title: this.importantdates,\n                        bodyHTML: this.generateImportantDates(Number(this.quizInfo.open), Number(this.quizInfo.close))\n                    })\n                );\n            }\n        }\n\n        if (Object.keys(this.Rubrics).length) {\n            content.append(\n                this.createBox({\n                    bg: 'bg-gray',\n                    titleColor: 'text-dark',\n                    icon: this.moduleIcon,\n                    title: this.rubrics,\n                    bodyHTML: this.generateRubrics(this.Rubrics)\n                })\n            );\n        }\n\n        if (Dates) {\n            content.append(\n                this.createBox({\n                    bg: 'bg-amber',\n                    titleColor: 'text-dark',\n                    icon: Icons.time,\n                    title: this.importantdates,\n                    bodyHTML: this.generateImportantDates(openDate, dueDate)\n                })\n            );\n        }\n        if (this.module === 'assign') {\n            content.append(\n                this.createBox({\n                    bg: 'bg-green',\n                    titleColor: 'text-success',\n                    icon: this.moduleIcon,\n                    title: this.subStatus,\n                    bodyHTML: this.submissionStatus(this.submission)\n                })\n            );\n        }\n\n        container.append(btnWrapper, header, content);\n        return container;\n\n    }\n    // Helper to create info boxes\n    createBox({bg, titleColor, icon, title, bodyHTML}) {\n        const box = this.create('div');\n        box.className = `tiny_cursive-fullpage-card ${bg}`;\n\n        const heading = this.create('h4');\n        heading.className = `tiny_cursive-fullpage-card-header ${titleColor} d-flex align-items-center`;\n        heading.innerHTML = `${icon} ${title}`;\n\n        const body = this.create('div');\n        body.className = `tiny_cursive-fullpage-card-body`;\n        body.innerHTML = bodyHTML;\n\n        box.append(heading, body);\n        return box;\n    }\n\n    generateRubrics(Rubrics) {\n        const wrapper = this.create('div');\n\n        Rubrics.forEach(rubric => {\n            const rubricDiv = this.create('div');\n            rubricDiv.className = 'tiny_cursive-rubric-card';\n\n            const title = this.create('h3');\n            title.className = 'tiny_cursive-rubric-title';\n            title.textContent = rubric.description;\n            rubricDiv.appendChild(title);\n\n            Object.values(rubric.levels).forEach(level => {\n                const levelDiv = this.create('div');\n                const score = Number(level.score);\n\n                // Assign background color class based on score\n                if (score === 0) {\n                    levelDiv.className = 'tiny_cursive-rubric-level tiny_cursive-rubric-low';\n                } else if (score <= 2) {\n                    levelDiv.className = 'tiny_cursive-rubric-level tiny_cursive-rubric-mid';\n                } else {\n                    levelDiv.className = 'tiny_cursive-rubric-level tiny_cursive-rubric-high';\n                }\n\n                levelDiv.textContent = `${level.definition} / ${level.score}`;\n                rubricDiv.appendChild(levelDiv);\n            });\n\n            wrapper.appendChild(rubricDiv);\n        });\n\n        return wrapper.innerHTML;\n    }\n\n    submissionStatus(submission) {\n        const wrapper = this.create('div');\n\n        const statusWrapper = this.create('div');\n        statusWrapper.className = 'tiny_cursive-status-row';\n\n        const statusName = this.create('span');\n        statusName.textContent = `${this.status}:`;\n\n        const statusValue = this.create('span');\n        const isNew = submission?.current?.status === 'new';\n        statusValue.textContent = isNew ? this.draftnot : this.draft;\n        statusValue.className = `tiny_cursive-status-value ${isNew ? 'tiny_cursive-status-red' : 'tiny_cursive-status-green'}`;\n\n        statusWrapper.append(statusName, statusValue);\n\n        const modifiedWrapper = this.create('div');\n        modifiedWrapper.className = 'tiny_cursive-status-row';\n\n        const modifiedName = this.create('span');\n        modifiedName.textContent = `${this.lastModified}: `;\n\n        const modifiedValue = this.create('span');\n        if (submission?.current?.timemodified) {\n            const date = new Date(submission.current.timemodified * 1000);\n            modifiedValue.textContent = this.formatDate(date);\n        } else {\n            modifiedValue.textContent = 'N/A';\n        }\n        modifiedWrapper.append(modifiedName, modifiedValue);\n\n        const gradeWrapper = this.create('div');\n        gradeWrapper.className = 'tiny_cursive-status-row';\n\n        const gradeName = this.create('span');\n        gradeName.textContent = `${this.gradings}: `;\n\n        const gradeValue = this.create('span');\n\n        if (submission?.grade) {\n            gradeValue.textContent = Number(submission.grade.grade) > 0\n                ? submission.grade.grade\n                : this.gradenot;\n        } else {\n            gradeValue.textContent = this.gradenot;\n        }\n\n        gradeWrapper.append(gradeName, gradeValue);\n        wrapper.append(statusWrapper, gradeWrapper, modifiedWrapper);\n        return wrapper.innerHTML;\n    }\n\n    wordCounter(status) {\n        const wordCount = this.create('div');\n        const labelDiv = this.create('div');\n        const label = this.create('span');\n        const value = this.create('span');\n        const icon = this.create('span');\n\n        icon.className = 'me-2';\n        icon.innerHTML = Icons.assignment;\n\n        labelDiv.appendChild(icon);\n        labelDiv.append(label);\n\n        label.textContent = `${this.wordCount}:`;\n        value.textContent = '0';\n        value.className = 'text-primary';\n        value.style.fontWeight = '600';\n        value.style.fontSize = '14px';\n\n        wordCount.className = 'bg-white rounded shadow-sm p-2 d-flex justify-content-between my-2';\n        wordCount.append(labelDiv, value);\n        wordCount.style.fontSize = '12px';\n\n        const observer = new MutationObserver(() => {\n            const newText = status.textContent.trim();\n            value.textContent = `${newText.replace('words', '')}`;\n        });\n\n        observer.observe(status, {\n            characterData: true,\n            subtree: true,\n            childList: true\n        });\n\n        return wordCount;\n    }\n\n\n    timerCountDown(timer) {\n\n        let warningDiv = document.querySelector('#user-notifications > div');\n        if (warningDiv) {\n            let clone = warningDiv.cloneNode(true);\n            clone.querySelector('button')?.remove();\n            this.editor.notificationManager.open({\n                text: clone.textContent,\n                type: 'error'\n            });\n        }\n\n\n        const timerCount = this.create('div');\n        timerCount.className = 'bg-white rounded shadow-sm p-2 d-flex justify-content-between my-2';\n\n        const labelDiv = this.create('div');\n        const label = this.create('span');\n        const value = this.create('span');\n        const icon = this.create('span');\n        icon.innerHTML = Icons.time;\n\n        labelDiv.appendChild(icon);\n        labelDiv.append(label);\n\n        label.textContent = `${this.timeleft}:`;\n        value.textContent = '00:00:00';\n        value.className = warningDiv ? 'text-danger' : 'text-primary';\n        Object.assign(value.style, {\n            fontWeight: '600',\n            fontSize: '14px'\n        });\n\n\n        timerCount.append(labelDiv, value);\n        timerCount.style.fontSize = '12px';\n        if (timer) {\n            const observer = new MutationObserver(() => {\n                const newText = timer.textContent.trim();\n                value.textContent = `${newText}`;\n            });\n            observer.observe(timer, {\n                characterData: true,\n                subtree: true,\n                childList: true\n            });\n        } else {\n            value.textContent = this.nolimit;\n        }\n\n\n        return timerCount;\n    }\n\n\n    generateStudentInfo(user, course) {\n\n        const wrapper = this.create('div');\n\n        const nameWrapper = this.create('div');\n        const usernameWrapper = this.create('div');\n        const courseWrapper = this.create('div');\n\n        const nameLabel = this.create('strong');\n        const nameValue = this.create('span');\n        const usernameLabel = this.create('strong');\n        const usernameValue = this.create('span');\n        const courseLabel = this.create('strong');\n        const courseValue = this.create('span');\n\n        nameLabel.textContent = `${this.name}`;\n        nameValue.textContent = user.fullname;\n\n        usernameLabel.textContent = `${this.userename}: `;\n        usernameValue.textContent = user.username;\n\n        courseLabel.textContent = `${this.course}: `;\n        courseValue.textContent = course.title;\n\n        usernameLabel.className = 'cfw-bold me-2';\n        usernameValue.className = 'cursiveFw-wrap';\n        courseLabel.className = 'cfw-bold me-2';\n        courseValue.className = 'cursiveFw-wrap';\n        nameLabel.className = 'cfw-bold me-2';\n        nameValue.className = 'cursiveFw-wrap';\n\n        nameWrapper.append(nameLabel, nameValue);\n        usernameWrapper.append(usernameLabel, usernameValue);\n        courseWrapper.append(courseLabel, courseValue);\n\n        wrapper.append(nameWrapper, usernameWrapper, courseWrapper);\n\n        return wrapper.innerHTML;\n\n    }\n\n    generateImportantDates(open, due) {\n\n        const wrapper = this.create('div');\n        let openDate = null;\n        let dueDate = null;\n\n        const openedWrapper = this.create('div');\n        const dueWrapper = this.create('div');\n        const remainingWrapper = this.create('div');\n\n        const openedLabel = this.create('span');\n        const openedValue = this.create('span');\n        const dueLabel = this.create('span');\n        const dueValue = this.create('span');\n        const remainingLabel = this.create('span');\n        const remainingValue = this.create('span');\n        if (this.module === 'quiz') {\n            openDate = open * 1000;\n            dueDate = due * 1000;\n        } else {\n            openDate = this.extractDate(open?.textContent);\n            dueDate = this.extractDate(due?.textContent);\n        }\n\n        openedLabel.textContent = `${this.opened}: `;\n        openedValue.textContent = this.formatDate(openDate ? new Date(openDate) : null);\n        openedValue.className = 'text-dark';\n\n        dueLabel.textContent = `${this.due}: `;\n        dueValue.textContent = this.formatDate(dueDate ? new Date(dueDate) : null);\n        dueValue.className = 'text-danger';\n\n        remainingLabel.textContent = `${this.remaining}: `;\n        remainingValue.textContent = this.calculateDate(dueDate);\n        remainingValue.className = 'text-danger';\n\n        openedWrapper.className = 'd-flex justify-content-between';\n        dueWrapper.className = 'd-flex justify-content-between';\n        remainingWrapper.className = 'd-flex align-items-center justify-content-between mt-2 pt-2 border-top';\n\n        openedWrapper.append(openedLabel, openedValue);\n        dueWrapper.append(dueLabel, dueValue);\n        remainingWrapper.append(remainingLabel, remainingValue);\n\n        wrapper.append(openedWrapper, dueWrapper, remainingWrapper);\n\n        return wrapper.innerHTML;\n    }\n\n    formatDate(date) {\n        if (!date) {\n            return '-';\n        }\n\n        let options = {year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric', hour12: true};\n        return date.toLocaleString('en-US', options);\n    }\n\n    extractDate(text) {\n        if (!text) {\n            return '-';\n        }\n        // Split on first colon and return the right part\n        const parts = text?.split(':');\n        if (parts.length > 1) {\n            return parts.slice(1).join(':').trim();\n        }\n\n        return text.trim();\n    }\n\n\n    calculateDate(date) {\n        if (!date) {\n            return '-';\n        }\n        const date1 = new Date(date); // Due date (local time)\n        const now = new Date(); // Current date/time\n\n        // Calculate the difference in milliseconds\n        const diffMs = date1 - now;\n\n        // Convert to days, hours, minutes\n        if (diffMs <= 0) {\n            return \"Overdue\";\n        } else {\n            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n            const diffHours = Math.floor((diffMs / (1000 * 60 * 60)) % 24);\n\n            return `${diffDays} days, ${diffHours} hours`;\n        }\n\n    }\n\n    fullPageModule(module) {\n        let current = this.module === 'quiz' ?\n            document.getElementById(`${module}_ifr`) : document.querySelector(`#${module}_ifr`);\n\n        let p1 = current.parentElement;\n        let p2 = p1.parentElement;\n        let p3 = p2.parentElement;\n        let p4 = p3.parentElement;\n\n        let statusBar = document.querySelector('.tox-statusbar__right-container > button');\n        let assignName = document.querySelector('.page-context-header');\n        let header = this.create('div');\n        let btn = null;\n\n        assignName.classList.remove('mb-2');\n        header.id = 'tiny_cursive-fullpage-custom-header';\n        Object.assign(header.style, {\n            backgroundColor: 'white',\n            display: 'flex',\n            justifyContent: 'space-between'\n        });\n\n        if (this.module === 'quiz') {\n            btn = document.querySelector('#mod_quiz-next-nav').cloneNode(true);\n            btn.className = 'tiny_cursive-fullpage-submit-btn';\n            btn.style.margin = '.5rem';\n        } else {\n            btn = this.create('input');\n            btn.className = 'tiny_cursive-fullpage-submit-btn';\n            btn.value = this.savechanges;\n            btn.type = 'submit';\n            btn.style.margin = '.5rem';\n        }\n\n        if (this.module === 'pdfannotator') {\n            const style = document.createElement('style');\n            style.id = 'cursiveForceStyle';\n            style.textContent = `\n                .path-mod-pdfannotator #comment-wrapper h4,\n                .path-mod-pdfannotator #comment-nav {\n                    margin: 0 !important;\n                }\n            `;\n            document.head.appendChild(style);\n        }\n\n        const leftSide = this.create('div');\n        const rightSide = this.create('div');\n        let commonStyle = {\n            display: 'flex',\n            alignItems: 'center',\n            margin: '0 1rem'\n        };\n\n        Object.assign(leftSide.style, commonStyle);\n        rightSide.id = 'tiny_cursive-fullpage-right-wrapper';\n        Object.assign(rightSide.style, commonStyle);\n\n        rightSide.appendChild(btn);\n        leftSide.appendChild(assignName.cloneNode(true));\n\n        header.appendChild(leftSide);\n        header.appendChild(rightSide);\n\n        p4.insertBefore(header, p4.firstChild);\n        p2.style.backgroundColor = '#efefef';\n        Object.assign(current.style, {\n            width: '750px',\n            minWidth: '750px',\n            boxShadow: '0 10px 15px -3px rgb(0 0 0/0.1),0 4px 6px -4px rgb(0 0 0/0.1)'\n        });\n\n        Object.assign(p1.style, {\n            display: 'flex',\n            justifyContent: 'center',\n            outline: 'none',\n            margin: '2rem 0 0'\n        });\n        const style = this.create('style');\n        style.id = 'tiny_cursive-fullpage-mode-style';\n        style.textContent = `\n            .tox.tox-edit-focus .tox-edit-area::before {\n                opacity: 0;\n            }`;\n        document.head.appendChild(style);\n\n        let iframeBody = current.contentDocument?.body || current.contentWindow?.document?.body;\n\n        if (iframeBody) {\n            iframeBody.style.padding = '0.5in';\n        }\n        p2.style.position = 'relative';\n        document.getElementById('cursive-fullpagemode-sidebar')?.remove();\n\n        let toggle = this.create('div');\n        toggle.id = 'cursive-fullpagemode-sidebar-toggle';\n        toggle.innerHTML = Icons.hamburger;\n        p2.appendChild(toggle);\n        p2.appendChild(this.docSideBar(statusBar));\n    }\n\n    normalizePage(editorId) {\n        document.getElementById('tiny_cursive-fullpage-custom-header')?.remove();\n        document.getElementById('cursive-fullpagemode-sidebar')?.remove();\n\n        let current = document.getElementById(editorId);\n        let p1 = current.parentElement;\n        let p2 = p1.parentElement;\n\n        Object.assign(p2.style, {\n            backgroundColor: \"\",\n            position: \"\"\n        });\n\n        Object.assign(current.style, {\n            width: '',\n            minWidth: '',\n            boxShadow: '',\n        });\n\n        Object.assign(p1.style, {\n            display: '',\n            justifyContent: '',\n            outline: '',\n            margin: ''\n        });\n\n        p1.classList.remove('tiny-cursive-editor-container');\n\n        let iframeBody = current.contentDocument?.body || current.contentWindow?.document?.body;\n        if (iframeBody) {\n            iframeBody.style.padding = '0';\n        }\n        document.head.querySelector('#tiny_cursive-fullpage-mode-style')?.remove();\n        document.head.querySelector('#cursiveForceStyle')?.remove();\n    }\n\n    checkForumSubject() {\n        const form = document.querySelector('#tiny_cursive-fullpage-right-wrapper > input');\n        const msg = this.subjectnot;\n\n        if (form) {\n            form.addEventListener('click', (e) => {\n                const subjectInput = document.getElementById('id_subject');\n                let content = this.editor.getContent().trim();\n                if (!subjectInput || subjectInput.value.trim() === '' || content === '') {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.editor.windowManager.alert(msg);\n                }\n            });\n        }\n    }\n\n    getSidebarTitle() {\n        const [assign, discus, quiz, lesson] = this.getText('sbTitle');\n        switch (this.module) {\n            case 'assign':\n                return {title: assign, icon: Icons.assignment};\n            case 'forum':\n                return {title: discus, icon: Icons.forum};\n            case 'lesson':\n                return {title: lesson, icon: Icons.forum};\n            case 'quiz':\n                return {title: quiz, icon: Icons.quiz};\n            case 'pdfannotator':\n                return {title: 'PDF Annotation', icon: Icons.pdfannotator};\n            default:\n                return {title: 'Page', icon: Icons.quiz};\n        }\n    }\n\n    getTimerBlock(module) {\n        switch (module) {\n            case 'assign':\n                return document.querySelector('#mod_assign_timelimit_block > div > div');\n            case 'forum':\n                return document.querySelector('#mod_forum_timelimit_block');\n            case 'lesson':\n                return document.querySelector('#lesson-timer');\n            case 'quiz':\n                return document.querySelector('#quiz-time-left');\n            default:\n                return null;\n        }\n    }\n\n    getQuestionId(editoId) {\n        try {\n            if (!editoId || typeof editoId !== 'string') {\n                return '';\n            }\n            return editoId.replace(/^q(\\d+):(\\d+)_.*$/, \"$1-$2\");\n        } catch (error) {\n            window.console.error('Error getting question ID:', error);\n            return '';\n        }\n    }\n\n    initStrings() {\n        [\n            this.details,\n            this.studentInfo,\n            this.progress,\n            this.description,\n            this.replyingto,\n            this.answeringto,\n            this.importantdates,\n            this.rubrics,\n            this.subStatus,\n            this.status,\n            this.draft,\n            this.draftnot,\n            this.lastModified,\n            this.gradings,\n            this.gradenot,\n            this.wordCount,\n            this.timeleft,\n            this.nolimit,\n            this.name,\n            this.userename,\n            this.course,\n            this.opened,\n            this.due,\n            this.overdue,\n            this.remaining,\n            this.savechanges,\n            this.subjectnot\n        ] = this.getText('docSideBar');\n    }\n\n    getText(key) {\n        return JSON.parse(localStorage.getItem(key)) || [];\n    }\n\n    create(tag) {\n        return document.createElement(tag);\n    }\n\n}"],"names":["constructor","User","Rubrics","submission","modulename","editor","quizInfo","module","moduleIcon","Icons","assignment","initStrings","normalMode","id","this","normalizePage","fullPageMode","fullPageModule","_this$editor2","forum","_this$editor3","_this$editor4","quiz","_this$editor5","lesson","_this$editor6","pdfannotator","_this$editor7","docSideBar","status","replyId","URL","window","location","href","searchParams","get","toggle","document","querySelector","timelimitBlock","getTimerBlock","headerInfo","getSidebarTitle","progressBar","courseName","courseDes","Dates","openDate","dueDate","container","create","Object","assign","className","style","width","overflow","crossBtn","innerHTML","close","addEventListener","transition","display","btnWrapper","padding","position","top","backgroundColor","append","header","headerTitle","textContent","title","details","fontWeight","headerIcon","prepend","cloneNode","wordCount","wordCounter","timerCountDown","content","createBox","bg","titleColor","icon","people","studentInfo","bodyHTML","generateStudentInfo","progress","trim","description","checkForumSubject","replyPost","replyingto","_this$editor8","questionId","getQuestionId","_this$editor9","question","intro","atob","answeringto","Number","open","time","importantdates","generateImportantDates","keys","length","rubrics","generateRubrics","subStatus","submissionStatus","box","heading","body","wrapper","forEach","rubric","rubricDiv","appendChild","values","levels","level","levelDiv","score","definition","statusWrapper","statusName","statusValue","isNew","current","draftnot","draft","modifiedWrapper","modifiedName","lastModified","modifiedValue","_submission$current2","timemodified","date","Date","formatDate","gradeWrapper","gradeName","gradings","gradeValue","grade","gradenot","labelDiv","label","value","fontSize","MutationObserver","newText","replace","observe","characterData","subtree","childList","timer","warningDiv","clone","remove","notificationManager","text","type","timerCount","timeleft","nolimit","user","course","nameWrapper","usernameWrapper","courseWrapper","nameLabel","nameValue","usernameLabel","usernameValue","courseLabel","courseValue","name","fullname","userename","username","due","openedWrapper","dueWrapper","remainingWrapper","openedLabel","openedValue","dueLabel","dueValue","remainingLabel","remainingValue","extractDate","opened","remaining","calculateDate","toLocaleString","year","month","day","hour","minute","hour12","parts","split","slice","join","diffMs","Math","floor","getElementById","p1","parentElement","p2","p4","statusBar","assignName","btn","classList","justifyContent","margin","savechanges","createElement","head","leftSide","rightSide","commonStyle","alignItems","insertBefore","firstChild","minWidth","boxShadow","outline","iframeBody","contentDocument","contentWindow","_current$contentWindo","_current$contentWindo2","hamburger","editorId","_current$contentWindo3","_current$contentWindo4","form","msg","subjectnot","e","subjectInput","getContent","preventDefault","stopPropagation","windowManager","alert","discus","getText","editoId","error","console","overdue","key","JSON","parse","localStorage","getItem","tag"],"mappings":"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"}