{"version":3,"file":"append_participants_table.min.js","sources":["../src/append_participants_table.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * @module     tiny_cursive/append_participants_table\r\n * @category TinyMCE Editor\r\n * @copyright  CTI <info@cursivetechnology.com>\r\n * @author kuldeep singh <mca.kuldeep.sekhon@gmail.com>\r\n */\r\n\r\ndefine([\"jquery\", \"core/config\", \"core/str\"], function($, mdlcfg, Str) {\r\n    var usersTable = {\r\n        init: async function(page) {\r\n            await usersTable.appendTable(page);\r\n        },\r\n        appendTable: async function() {\r\n            $(document).ready(async function($) {\r\n                // Get the first row in the table header\r\n                let hTr = $('thead').find('tr').get()[0];\r\n                let courseid = M.cfg.courseId;\r\n\r\n                // Fetch string for stats header\r\n                let statsString = await Str.get_string('stats', 'tiny_cursive');\r\n\r\n                // Add the stats header if it doesn't already exist\r\n                if (!$(hTr).find('#stats').length) {\r\n                    $(hTr).find('th').eq(6).after('<th class=\"header c7\" id=\"stats\">' + statsString + '</th>');\r\n                }\r\n\r\n                // Iterate over each row in the table body\r\n                $('tbody').find(\"tr\").get().forEach(function(tr) {\r\n                    let tdUser = $(tr).find(\"td\").get()[0];\r\n                    let userid = $(tdUser).find(\"input\").get()[0]?.id;\r\n                    userid = userid?.slice(4); // Extract userid from input id\r\n\r\n                    if (userid) {\r\n                        // Avoid duplicating the icon by checking if the icon is already added\r\n                        if (!$(tr).find('td').eq(6).find('i').length) {\r\n                            let color = 'font-size:24px;color:black;text-decoration:none';\r\n                            let link = mdlcfg.wwwroot + \"/lib/editor/tiny/plugins/cursive/writing_report.php?userid=\"\r\n                                + userid + \"&courseid=\" + courseid;\r\n                            let icon = 'fa fa-area-chart';\r\n\r\n                            // Add the icon link to the 6th column\r\n                            let thunderIcon = '<td><a href=\"' + link + '\" data-id=' + userid + '>' +\r\n                                '<i class=\"' + icon + '\" aria-hidden=\"true\" style=\"' + color + '\"></i></a></td>';\r\n                            $(tr).find('td').eq(5).after(thunderIcon); // Insert after the 5th column\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // Add event listener for page change or other events triggering table update\r\n                $(\".page-item, .header\").on('click', function() {\r\n                    setTimeout(() => {\r\n                        // Prevent multiple initializations by checking if already initialized\r\n                        if (!$('#stats').length) {\r\n                            usersTable.init(); // Initialize the table if needed\r\n                        }\r\n                    }, 1800); // Slight delay to ensure the DOM is fully updated\r\n                });\r\n            });\r\n        }\r\n    };\r\n    return usersTable;\r\n});\r\n"],"names":["define","$","mdlcfg","Str","usersTable","init","async","page","appendTable","document","ready","hTr","find","get","courseid","M","cfg","courseId","statsString","get_string","length","eq","after","forEach","tr","tdUser","userid","_$$find$get$","id","_userid","slice","color","thunderIcon","wwwroot","on","setTimeout"],"mappings":"AAsBAA,gDAAO,CAAC,SAAU,cAAe,aAAa,SAASC,EAAGC,OAAQC,SAC1DC,WAAa,CACbC,KAAMC,eAAeC,YACXH,WAAWI,YAAYD,OAEjCC,YAAaF,iBACTL,EAAEQ,UAAUC,OAAMJ,eAAeL,OAEzBU,IAAMV,EAAE,SAASW,KAAK,MAAMC,MAAM,GAClCC,SAAWC,EAAEC,IAAIC,SAGjBC,kBAAoBf,IAAIgB,WAAW,QAAS,gBAG3ClB,EAAEU,KAAKC,KAAK,UAAUQ,QACvBnB,EAAEU,KAAKC,KAAK,MAAMS,GAAG,GAAGC,MAAM,oCAAsCJ,YAAc,SAItFjB,EAAE,SAASW,KAAK,MAAMC,MAAMU,SAAQ,SAASC,iCACrCC,OAASxB,EAAEuB,IAAIZ,KAAK,MAAMC,MAAM,GAChCa,4BAASzB,EAAEwB,QAAQb,KAAK,SAASC,MAAM,kCAA9Bc,aAAkCC,MAC/CF,uBAASA,iCAAAG,QAAQC,MAAM,GAEnBJ,SAEKzB,EAAEuB,IAAIZ,KAAK,MAAMS,GAAG,GAAGT,KAAK,KAAKQ,OAAQ,KACtCW,MAAQ,kDAMRC,YAAc,iBALP9B,OAAO+B,QAAU,8DACtBP,OAAS,aAAeZ,UAIa,aAAeY,OAAxC,cAHP,mBAIe,+BAAiCK,MAAQ,kBACnE9B,EAAEuB,IAAIZ,KAAK,MAAMS,GAAG,GAAGC,MAAMU,iBAMzC/B,EAAE,uBAAuBiC,GAAG,SAAS,WACjCC,YAAW,KAEFlC,EAAE,UAAUmB,QACbhB,WAAWC,SAEhB,qBAKZD"}