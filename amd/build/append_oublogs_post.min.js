define("tiny_cursive/append_oublogs_post",["exports","core/ajax","core/templates","./analytic_events","./analytic_button","./replay"],(function(_exports,_ajax,_templates,_analytic_events,_analytic_button,_replay){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * This module provides functionality to append blog posts in the OU Blogs plugin for TinyMCE editor
   *
   * @module     tiny_cursive/append_oublogs_post
   * @copyright  2025  CTI <info@cursivetechnology.com>
   * @author     Brain Station 23 <sales@brainstation-23.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=_interopRequireDefault(_templates),_analytic_events=_interopRequireDefault(_analytic_events),_analytic_button=_interopRequireDefault(_analytic_button),_replay=_interopRequireDefault(_replay);_exports.init=(scoreSetting,comments,hasApiKey)=>{const replayInstances={};window.video_playback=function(mid,filepath){if(""!==filepath){const replay=new _replay.default("content"+mid,filepath,10,!1,"player_"+mid);replayInstances[mid]=replay}else _templates.default.render("tiny_cursive/no_submission").then((html=>{const contentElement=document.getElementById("content"+mid);return contentElement&&(contentElement.innerHTML=html),contentElement})).catch((e=>window.console.error(e)));return!1};const ouBlogPosts=document.querySelectorAll(".oublog-post"),cmid=M.cfg.contextInstanceId;ouBlogPosts.forEach((function(element){const postedByLink=element.querySelector(".oublog-postedby a"),permalinkElement=element.querySelector(".oublog-post-links a"),postedByHref=postedByLink.getAttribute("href"),permalink=permalinkElement.getAttribute("href"),resourceIdParam=new URLSearchParams(permalink.split("?")[1]).get("post"),useridParam=new URLSearchParams(postedByHref.split("?")[1]).get("id"),resourceId=resourceIdParam?parseInt(resourceIdParam):0,userid=useridParam?parseInt(useridParam):0;let filepath="";if(userid&&resourceId){let args={id:userid,resourceid:resourceId,modulename:"oublog",cmid:cmid},methodname="cursive_get_oublog_submission_data",com=(0,_ajax.call)([{methodname:methodname,args:args}]);com[0].done((function(json){var data=JSON.parse(json);data.res.filename&&(filepath=data.res.filename);const postLinksElement=element.querySelector(".oublog-post-links");postLinksElement&&postLinksElement.append((0,_analytic_button.default)(hasApiKey?data.res.effort_ratio:"",userid));const myEvents=new _analytic_events.default,context={tabledata:data.res,formattime:myEvents.formatedTime(data.res),page:scoreSetting,userid:userid,apikey:hasApiKey},authIcon=myEvents.authorshipStatus(data.res.first_file,data.res.score,scoreSetting);myEvents.createModal(userid,context,"",replayInstances,authIcon),myEvents.analytics(userid,_templates.default,context,"",replayInstances,authIcon),myEvents.checkDiff(userid,data.res.file_id,"",replayInstances),myEvents.replyWriting(userid,filepath,"",replayInstances)})),com[0].fail((error=>{window.console.error(error)}))}}))}}));

//# sourceMappingURL=append_oublogs_post.min.js.map